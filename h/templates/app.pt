<metal:main use-macro="load: base.pt">
  <div id="toolbar" metal:fill-slot="toolbar">
    <img class="tab-logo"
         src="${request.static_url('h:images/hypothelogo_square.png')}" />
    <form tal:condition="request.user" tal:replace="structure form" />
  </div>

  <div id="header" metal:fill-slot="header">
    <div tal:attributes="class 'hyp-widget'"
         tal:condition="not request.user">
      <form metal:use-macro="auth" tal:define="auth load: auth.pt" />
    </div>
  </div>

  <div id="app" metal:fill-slot="content">
    <script tal:attributes="src src"
            tal:repeat="src environment['annotator'].urls()"></script>
    <script tal:attributes="src src"
            tal:repeat="src environment['d3'].urls()"></script>
    <script tal:attributes="src src"
            tal:repeat="src environment['easyXDM'].urls()"></script>
    <script tal:attributes="src src"
            tal:repeat="src environment['handlebars'].urls()"></script>
    <script tal:attributes="src src"
            tal:repeat="src environment['jwz'].urls()"></script>
    <script tal:attributes="src src"
            tal:repeat="src environment['templates'].urls()"></script>
    <script tal:attributes="src src"
            tal:repeat="src environment['underscore'].urls()"></script>
    <script>
      window.annotator = new Hypothesis(document.body, {
      Auth: {
      tokenUrl: '${request.route_url('token')}'
      },
      Heatmap: {}
      })
    </script>
  </div>
</metal:main>
