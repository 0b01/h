<!DOCTYPE html>
<html lang="en" metal:use-macro="main_template">
  <body data-ng-app="h" data-ng-controller="App" metal:fill-slot="body">
    <div id="toolbar" class="form-inline">
      <div data-ng-click="toggleShow()" class="tri"></div>
      <div class="tinyman">
        <a data-ng-hide="persona"
           data-ng-click="$broadcast('showAuth')">Sign in</a>
        <form id="persona"
              action
              method="POST"
              enctype="multipart/form-data"
              accept-charset="utf-8">
          <input name="__formid__" type="hidden" value="persona" />
          <div class="dropdown"
               data-ng-show="persona">
            <a role="button"
               class="dropdown-toggle"
               data-toggle="dropdown"
               >{{persona.username}}<span class="provider"
                                          >/{{persona.provider}}</span></a>
            <ul class="dropdown-menu pull-right"
                role="menu">
              <li data-ng-repeat="option in personas">
                <a data-ng-click="persona = personas[$index]"
                   >{{option.username}}/{{option.provider}}</a>
              </li>
              <li>
                <a data-ng-click="persona = null">Sign out</a>
              </li>
            </ul>
          </div>
        </form>
      </div>
    </div>
    <div id="gutter">
      <header data-ng-class="auth || 'collapsed'"
              data-ng-model="auth"
              data-ng-submit="submit()"
              data-tab-reveal="['forgot','activate']"
              class="form-vertical sheet tabbable">
        <a data-ng-click="auth = null" class="close"></a>
        <div data-title="Sign in"
             data-value="login"
             class="tab-pane">
          ${structure: layout.forms['login'].render()}
        </div>
        <div data-title="Create an account"
             data-value="register"
             class="tab-pane">
          ${structure: layout.forms['register'].render()}
        </div>
        <div data-title="Forgot your password?"
             data-value="forgot"
             class="tab-pane">
          ${structure: layout.forms['forgot'].render()}
        </div>
        <div data-title="Set your password"
             data-value="activate"
             class="tab-pane">
          ${structure: layout.forms['activate'].render()}
        </div>
        <footer>
          <ul>
            <li>
              <a data-ng-click="auth = 'forgot'">Password help?</a>
            </li>
            <li>
              <a data-ng-click="auth = 'activate'">Have you already reserved a
                username with us?</a>
            </li>
          </ul>
        </footer>
      </header>
      <div id="wrapper" data-ng-view=""></div>
    </div>
    <script type="text/ng-template" id="annotation.html">
      <metal:main use-macro="load: annotation.html" />
    </script>
    <script type="text/ng-template" id="editor.html">
      <metal:main use-macro="load: editor.html" />
    </script>
    <script type="text/ng-template" id="viewer.html">
      <metal:main use-macro="load: viewer.html" />
    </script>
  </body>
</html>
